# Scripts ä½¿ç”¨æŒ‡å—

é¡¹ç›®æä¾›äº†å¤šä¸ªå‘å¸ƒå’Œç®¡ç†è„šæœ¬ï¼Œä½äº `./scripts/` ç›®å½•ä¸‹ã€‚ç°å·²å‡çº§ä¸º**æ¨¡å—åŒ–æ¶æ„**ï¼Œæä¾›æ›´çµæ´»ã€ä¸“ä¸šçš„å‘å¸ƒä½“éªŒã€‚

## ğŸ“‚ Scripts ç›®å½•ç»“æ„

### ğŸ†• æ¨¡å—åŒ–æ¶æ„ (v3.0)

```
scripts/
â”œâ”€â”€ modules/                        # ç‹¬ç«‹åŠŸèƒ½æ¨¡å—
â”‚   â”œâ”€â”€ check-uncommitted.sh       # æ™ºèƒ½æœªæäº¤ä»£ç å¤„ç†
â”‚   â”œâ”€â”€ version-bump.sh             # æ™ºèƒ½ç‰ˆæœ¬æå‡é€‰æ‹©
â”‚   â”œâ”€â”€ create-tag.sh               # åˆ›å»ºtagå’Œæäº¤
â”‚   â””â”€â”€ monitor-release.sh          # å‘å¸ƒçŠ¶æ€ç›‘æ§
â”œâ”€â”€ smart-release-v3.sh             # ğŸŒŸ ä¸»æ§æ™ºèƒ½å‘å¸ƒè„šæœ¬
â”œâ”€â”€ release.sh                      # å®Œæ•´å‘å¸ƒæµç¨‹ï¼ˆç»å…¸ç‰ˆæœ¬ï¼‰
â”œâ”€â”€ quick-release.sh                # å¿«é€Ÿå‘å¸ƒæµç¨‹ï¼ˆç»å…¸ç‰ˆæœ¬ï¼‰
â””â”€â”€ publish-local.sh                # æœ¬åœ°å‘å¸ƒè„šæœ¬ï¼ˆè°ƒè¯•ç”¨ï¼‰
```

## ğŸŒŸ æ¨¡å—åŒ–æ™ºèƒ½å‘å¸ƒè„šæœ¬ï¼ˆæ¨èï¼‰

### `smart-release-v3.sh` - ä¸»æ§æ™ºèƒ½å‘å¸ƒè„šæœ¬

**ğŸ¯ å®Œå…¨æŒ‰ç…§ä¸“ä¸šå‘å¸ƒæµç¨‹è®¾è®¡**ï¼Œå®ç°å››ä¸ªç‹¬ç«‹æ­¥éª¤çš„å®Œç¾ç»„åˆï¼š

#### ğŸ“‹ å‘å¸ƒæµç¨‹
1. **æ£€æŸ¥å·¥ä½œç›®å½•çŠ¶æ€** - æ™ºèƒ½å¤„ç†æœªæäº¤ä»£ç 
2. **ç‰ˆæœ¬ç®¡ç†** - å¯é€‰æ‹©ç‰ˆæœ¬å‡çº§æˆ–ä½¿ç”¨ç°æœ‰ç‰ˆæœ¬
3. **åˆ›å»ºtagå’Œæäº¤** - çº¯tagæ“ä½œï¼Œè§¦å‘GitHub Actions
4. **ç›‘æ§å‘å¸ƒçŠ¶æ€** - 5åˆ†é’Ÿå®æ—¶ç›‘æ§ï¼Œè‡ªåŠ¨ç¡®è®¤æˆåŠŸ

#### ğŸš€ ä½¿ç”¨æ–¹æ³•

```bash
# å®Œæ•´æ™ºèƒ½å‘å¸ƒæµç¨‹
./scripts/smart-release-v3.sh

# è·³è¿‡ç‰ˆæœ¬å‡çº§ï¼Œä½¿ç”¨å½“å‰ç‰ˆæœ¬
./scripts/smart-release-v3.sh --skip-version

# ç›´æ¥æŒ‡å®šç‰ˆæœ¬ç±»å‹
./scripts/smart-release-v3.sh --version-type minor

# ä¸ç›‘æ§å‘å¸ƒçŠ¶æ€
./scripts/smart-release-v3.sh --no-monitor

# æŸ¥çœ‹å¸®åŠ©
./scripts/smart-release-v3.sh --help
```

#### âœ¨ æ™ºèƒ½ç‰¹æ€§

- **æ™ºèƒ½æœªæäº¤ä»£ç å¤„ç†**: 3ç§å¤„ç†é€‰é¡¹ï¼ˆæäº¤/æš‚å­˜/å–æ¶ˆï¼‰
- **æ™ºèƒ½ç‰ˆæœ¬æ¨è**: åŸºäºgitæäº¤å†å²åˆ†ææ¨èåˆé€‚ç‰ˆæœ¬
- **å®æ—¶å‘å¸ƒç›‘æ§**: ç›‘æ§GitHub Actionsã€NPMåŒ…ã€GitHub ReleaseçŠ¶æ€
- **å®Œæ•´é“¾æ¥è¾“å‡º**: è‡ªåŠ¨ç”Ÿæˆæ‰€æœ‰ç›¸å…³ç›‘æ§å’Œè®¿é—®é“¾æ¥
- **ä¸“ä¸šé”™è¯¯å¤„ç†**: æ¯æ­¥éƒ½æœ‰é”™è¯¯æ£€æŸ¥å’Œæ¢å¤æç¤º

## ğŸ”§ ç‹¬ç«‹æ¨¡å—è„šæœ¬

æ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œä¾¿äºæµ‹è¯•å’Œè°ƒè¯•ï¼š

### 1. `modules/check-uncommitted.sh` - ä»£ç çŠ¶æ€æ£€æŸ¥

```bash
# æ£€æŸ¥å·¥ä½œç›®å½•çŠ¶æ€
./scripts/modules/check-uncommitted.sh
```

**åŠŸèƒ½**:
- æ£€æµ‹æœªæäº¤çš„æ›´æ”¹
- æä¾›3ç§æ™ºèƒ½å¤„ç†é€‰é¡¹ï¼šæäº¤ã€æš‚å­˜ã€å–æ¶ˆ
- ç»™å‡ºæ¸…æ™°çš„æ“ä½œæŒ‡å¯¼

### 2. `modules/version-bump.sh` - ç‰ˆæœ¬ç®¡ç†

```bash
# äº¤äº’å¼ç‰ˆæœ¬é€‰æ‹©
./scripts/modules/version-bump.sh

# ç›´æ¥æŒ‡å®šç‰ˆæœ¬ç±»å‹
./scripts/modules/version-bump.sh patch
./scripts/modules/version-bump.sh minor
./scripts/modules/version-bump.sh major

# æµ‹è¯•æ¨¡å¼ï¼ˆä¸æ‰§è¡Œå®é™…å‡çº§ï¼‰
./scripts/modules/version-bump.sh test
```

**åŠŸèƒ½**:
- åŸºäºgitæäº¤å†å²çš„æ™ºèƒ½ç‰ˆæœ¬æ¨è
- 5ç§ç‰ˆæœ¬é€‰æ‹©ï¼špatchã€minorã€majorã€prereleaseã€custom
- ç‰ˆæœ¬é¢„è§ˆå’Œç¡®è®¤æœºåˆ¶

### 3. `modules/create-tag.sh` - Tagåˆ›å»º

```bash
# æ ¹æ®å½“å‰package.jsonç‰ˆæœ¬åˆ›å»ºtag
./scripts/modules/create-tag.sh
```

**åŠŸèƒ½**:
- æ ¹æ®package.jsonç‰ˆæœ¬å·åˆ›å»ºtag
- ä¸è¿›è¡Œç‰ˆæœ¬å‡çº§ï¼Œçº¯tagæ“ä½œ
- è‡ªåŠ¨æäº¤å’Œæ¨é€ï¼Œè§¦å‘GitHub Actions

### 4. `modules/monitor-release.sh` - å‘å¸ƒç›‘æ§

```bash
# ç›‘æ§å½“å‰ç‰ˆæœ¬çš„å‘å¸ƒçŠ¶æ€
./scripts/modules/monitor-release.sh
```

**åŠŸèƒ½**:
- 5åˆ†é’Ÿè¶…æ—¶çš„å®æ—¶ç›‘æ§
- å¹¶è¡Œæ£€æŸ¥GitHub Actionsã€NPMåŒ…ã€GitHub Release
- è¾“å‡ºå®Œæ•´çš„ç›‘æ§é“¾æ¥
- ç”Ÿæˆå‘å¸ƒçŠ¶æ€æ€»ç»“æŠ¥å‘Š

## ğŸ“Š ç»å…¸å‘å¸ƒè„šæœ¬

### 1. `quick-release.sh` - å¿«é€Ÿå‘å¸ƒ

**é€‚ç”¨åœºæ™¯**: æ—¥å¸¸å¼€å‘ä¸­çš„å°ç‰ˆæœ¬å‘å¸ƒ

```bash
# äº¤äº’å¼é€‰æ‹©ç‰ˆæœ¬ç±»å‹
./scripts/quick-release.sh

# ç›´æ¥æŒ‡å®šç‰ˆæœ¬ç±»å‹
./scripts/quick-release.sh patch   # ä¿®è®¢ç‰ˆæœ¬
./scripts/quick-release.sh minor   # æ¬¡ç‰ˆæœ¬
./scripts/quick-release.sh major   # ä¸»ç‰ˆæœ¬
```

### 2. `release.sh` - å®Œæ•´å‘å¸ƒæµç¨‹

**é€‚ç”¨åœºæ™¯**: é‡è¦ç‰ˆæœ¬å‘å¸ƒï¼Œéœ€è¦åˆ†æ”¯ç®¡ç†

```bash
# å¯åŠ¨å®Œæ•´å‘å¸ƒæµç¨‹
./scripts/release.sh
```

**ç‰¹ç‚¹**:
- åˆ›å»ºä¸“ç”¨çš„releaseåˆ†æ”¯
- æ™ºèƒ½ç‰ˆæœ¬å»ºè®®å’Œè¯¦ç»†changelog
- æ”¯æŒprereleaseå’Œè‡ªå®šä¹‰ç‰ˆæœ¬

## ğŸ†š ç‰ˆæœ¬å¯¹æ¯”

| ç‰¹æ€§ | smart-release-v3.sh | ç»å…¸è„šæœ¬ | ç‹¬ç«‹æ¨¡å— |
|------|---------------------|----------|----------|
| **æ¨¡å—åŒ–è®¾è®¡** | âœ… | âŒ | âœ… |
| **å‘å¸ƒç›‘æ§** | âœ… 5åˆ†é’Ÿå®æ—¶ç›‘æ§ | âŒ ä»…æä¾›é“¾æ¥ | âœ… |
| **æ™ºèƒ½ä»£ç å¤„ç†** | âœ… 3ç§é€‰é¡¹ | âŒ ç›´æ¥æ‹’ç» | âœ… |
| **å‚æ•°æ”¯æŒ** | âœ… ä¸°å¯Œçš„é€‰é¡¹ | ğŸŸ¡ åŸºæœ¬æ”¯æŒ | âœ… |
| **é”™è¯¯æ¢å¤** | âœ… ä¸“ä¸šçº§ | ğŸŸ¡ åŸºæœ¬ | âœ… |
| **å¯æµ‹è¯•æ€§** | âœ… é«˜ | ğŸŸ¡ ä¸­ç­‰ | âœ… |

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### ğŸ¯ æ¨èä½¿ç”¨åœºæ™¯

1. **æ—¥å¸¸å‘å¸ƒ**: ä½¿ç”¨ `smart-release-v3.sh` - æœ€å®Œæ•´çš„æ™ºèƒ½ä½“éªŒ
2. **å¿«é€Ÿæµ‹è¯•**: ä½¿ç”¨ `smart-release-v3.sh --no-monitor` - è·³è¿‡ç›‘æ§
3. **ä»…å‡çº§ç‰ˆæœ¬**: ä½¿ç”¨ `modules/version-bump.sh` - ç‹¬ç«‹ç‰ˆæœ¬ç®¡ç†
4. **è°ƒè¯•ç›‘æ§**: ä½¿ç”¨ `modules/monitor-release.sh` - ç‹¬ç«‹æµ‹è¯•ç›‘æ§åŠŸèƒ½
5. **ä¼ ç»Ÿå‘å¸ƒ**: ä½¿ç”¨ç»å…¸è„šæœ¬ä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ

### ğŸš€ æœ€ä½³å®è·µ

1. **é¦–æ¬¡ä½¿ç”¨**: å…ˆè¿è¡Œ `smart-release-v3.sh --help` äº†è§£é€‰é¡¹
2. **æµ‹è¯•ç¯å¢ƒ**: ä½¿ç”¨ `--no-monitor` è·³è¿‡ç›‘æ§ï¼ŒèŠ‚çœæ—¶é—´  
3. **ç‰ˆæœ¬è§„åˆ’**: éµå¾ª[è¯­ä¹‰åŒ–ç‰ˆæœ¬](https://semver.org/lang/zh-CN/)è§„èŒƒ
4. **æäº¤è§„èŒƒ**: ä½¿ç”¨[çº¦å®šå¼æäº¤](https://www.conventionalcommits.org/zh-hans/)ï¼Œè·å¾—æ™ºèƒ½ç‰ˆæœ¬æ¨è
5. **æ¨¡å—æµ‹è¯•**: å•ç‹¬æµ‹è¯•å„æ¨¡å—åŠŸèƒ½ï¼Œç¡®ä¿ç¯å¢ƒæ­£ç¡®

## ğŸ”— NPM Scripts å¿«æ·æ–¹å¼

åœ¨package.jsonä¸­çš„å¿«æ·æ–¹å¼ï¼š

```bash
# æ™ºèƒ½å‘å¸ƒï¼ˆæ¨èï¼‰
pnpm run release:smart      # = ./scripts/smart-release-v3.sh

# ç»å…¸å‘å¸ƒ
pnpm run release            # = ./scripts/release.sh
pnpm run release:patch      # = ./scripts/quick-release.sh patch
pnpm run release:minor      # = ./scripts/quick-release.sh minor
pnpm run release:major      # = ./scripts/quick-release.sh major

# æœ¬åœ°å‘å¸ƒ
pnpm run publish:local      # = ./scripts/publish-local.sh
```

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. ç¯å¢ƒè¦æ±‚
- âœ… Node.js å’Œ pnpm å·²å®‰è£…
- âœ… Git ä»“åº“ï¼Œå·¥ä½œç›®å½•ç›¸å¯¹å¹²å‡€
- âœ… NPM_TOKEN å·²åœ¨ GitHub Secrets ä¸­é…ç½®
- âœ… curl å·²å®‰è£…ï¼ˆç”¨äºå‘å¸ƒçŠ¶æ€ç›‘æ§ï¼‰

### 2. æƒé™è®¾ç½®
```bash
# ç»™è„šæœ¬æ·»åŠ æ‰§è¡Œæƒé™ï¼ˆé¦–æ¬¡ä½¿ç”¨ï¼‰
chmod +x scripts/**/*.sh
```

### 3. æ•…éšœæ’æŸ¥
- **æ¨¡å—æœªæ‰¾åˆ°**: æ£€æŸ¥ `scripts/modules/` ç›®å½•æ˜¯å¦å­˜åœ¨
- **æƒé™é”™è¯¯**: è¿è¡Œ `chmod +x scripts/**/*.sh`
- **ç›‘æ§è¶…æ—¶**: 5åˆ†é’Ÿåè¶…æ—¶æ˜¯æ­£å¸¸çš„ï¼Œè¯·æ‰‹åŠ¨æ£€æŸ¥é“¾æ¥
- **ç‰ˆæœ¬å†²çª**: æ£€æŸ¥ package.json ç‰ˆæœ¬å·æ˜¯å¦æ­£ç¡®

---

ğŸ‰ **æ¨è**: ç«‹å³ä½“éªŒ `./scripts/smart-release-v3.sh` è·å¾—æœ€ä½³çš„æ™ºèƒ½å‘å¸ƒä½“éªŒï¼