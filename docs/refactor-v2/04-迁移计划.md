# è¿ç§»è®¡åˆ’ï¼ˆä»ç°æœ‰æ¶æ„åˆ°æ–°æ¶æ„ï¼‰

> åˆ†é˜¶æ®µè¿ç§»ç­–ç•¥ï¼Œç¡®ä¿å¹³ç¨³è¿‡æ¸¡ã€é›¶å›é€€ã€å¯éšæ—¶å›æ»š
>
> **åŸåˆ™ï¼š** å‘åå…¼å®¹ + æ¸è¿›è¿ç§» + éªŒè¯ä¼˜å…ˆ

---

## ä¸€ã€è¿ç§»æ¦‚è¿°

### 1.1 è¿ç§»ç›®æ ‡

| ç›®æ ‡ | è¯´æ˜ |
|------|------|
| **åŠŸèƒ½ä¿ç•™** | æ‰€æœ‰ç°æœ‰åŠŸèƒ½å¿…é¡»ä¿ç•™ |
| **æ•°æ®å…¼å®¹** | `~/.ccman/*.json` æ ¼å¼ä¸å˜ |
| **å‘åå…¼å®¹** | æ—§ API ä¿ç•™ä½†æ ‡è®° deprecated |
| **é›¶å›é€€** | ç”¨æˆ·æ— æ„ŸçŸ¥ |
| **å¯å›æ»š** | ä»»ä½•é˜¶æ®µéƒ½å¯å¿«é€Ÿå›é€€ |

### 1.2 è¿ç§»é˜¶æ®µ

```
Phase 0: å‡†å¤‡æœŸï¼ˆ1 å‘¨ï¼‰
   â†“
Phase 1: Core é‡æ„ï¼ˆ2 å‘¨ï¼‰
   â†“
Phase 2: CLI è¿ç§»ï¼ˆ1 å‘¨ï¼‰
   â†“
Phase 3: Desktop è¿ç§»ï¼ˆ1 å‘¨ï¼‰
   â†“
Phase 4: æ¸…ç†å’Œå‘å¸ƒï¼ˆ1 å‘¨ï¼‰

æ€»è®¡ï¼š6 å‘¨
```

---

## äºŒã€Phase 0ï¼šå‡†å¤‡æœŸï¼ˆWeek 1ï¼‰

### 2.1 ä»»åŠ¡æ¸…å•

- [ ] å†»ç»“ç°æœ‰åŠŸèƒ½ï¼ˆä¸å†æ–°å¢åŠŸèƒ½ï¼Œåªä¿® bugï¼‰
- [ ] åˆ›å»º `refactor-v2` åˆ†æ”¯
- [ ] å®Œæˆè®¾è®¡æ–‡æ¡£è¯„å®¡
- [ ] å‡†å¤‡æµ‹è¯•ç¯å¢ƒ
  - [ ] `/tmp/ccman-test` å›ºå®šè·¯å¾„
  - [ ] æµ‹è¯•æ•°æ®å‡†å¤‡
- [ ] åˆ›å»ºå…¼å®¹å±‚ç›®å½•ç»“æ„

### 2.2 ç›®å½•ç»“æ„å‡†å¤‡

```
packages/core/
â”œâ”€â”€ tools/                 # æ–°æ¶æ„ï¼šå·¥å…·æè¿°ç¬¦å’Œé€‚é…å™¨
â”‚   â”œâ”€â”€ ccman/
â”‚   â”œâ”€â”€ claude-code/
â”‚   â”œâ”€â”€ codex/
â”‚   â””â”€â”€ gemini-cli/
â”œâ”€â”€ services/              # æ–°æ¶æ„ï¼šCore Services
â”‚   â”œâ”€â”€ tool-registry.ts
â”‚   â”œâ”€â”€ provider-service.ts
â”‚   â”œâ”€â”€ mcp-service.ts
â”‚   â”œâ”€â”€ config-service.ts
â”‚   â”œâ”€â”€ sync-service.ts
â”‚   â””â”€â”€ tool-orchestrator.ts
â”œâ”€â”€ adapters/              # æ–°æ¶æ„ï¼šåŸºç¡€è®¾æ–½å±‚
â”‚   â”œâ”€â”€ filesystem.ts
â”‚   â”œâ”€â”€ template-engine.ts
â”‚   â”œâ”€â”€ crypto.ts
â”‚   â””â”€â”€ webdav.ts
â”œâ”€â”€ compat/                # å…¼å®¹å±‚ï¼ˆæ—§ APIï¼‰
â”‚   â”œâ”€â”€ tool-manager.ts   # æ—§çš„å·¥å‚å‡½æ•°
â”‚   â””â”€â”€ writers/          # æ—§çš„ writersï¼ˆä»£ç†åˆ°æ–° adaptersï¼‰
â””â”€â”€ index.ts               # å¯¼å‡ºæ–°æ—§ API
```

---

## ä¸‰ã€Phase 1ï¼šCore é‡æ„ï¼ˆWeek 2-3ï¼‰

### 3.1 ä»»åŠ¡åˆ†è§£

#### Week 2: åŸºç¡€è®¾æ–½å’Œå·¥å…·æ³¨å†Œ

- [ ] å®ç° `ToolRegistry`
- [ ] å®ç° `TemplateEngine`
- [ ] å®ç° `FileSystem` é€‚é…å™¨ï¼ˆå¤‡ä»½ã€é”ã€åŸå­å†™å…¥ï¼‰
- [ ] å®ç° `PathResolver`ï¼ˆæ ¹ç›®å½•ç®¡ç†ï¼‰
- [ ] ä¸ºç°æœ‰ 3 ä¸ªå·¥å…·åˆ›å»º `ToolDescriptor`
  - [ ] `tools/claude-code/descriptor.ts`
  - [ ] `tools/codex/descriptor.ts`
  - [ ] `tools/gemini-cli/descriptor.ts`
- [ ] ä¸ºç°æœ‰ 3 ä¸ªå·¥å…·åˆ›å»º `ServiceAdapter`
  - [ ] å°†ç°æœ‰çš„ `writers/claude.ts` é‡æ„ä¸º `tools/claude-code/service-adapter.ts`
  - [ ] å°†ç°æœ‰çš„ `writers/codex.ts` é‡æ„ä¸º `tools/codex/service-adapter.ts`
  - [ ] å°†ç°æœ‰çš„ `writers/gemini.ts` é‡æ„ä¸º `tools/gemini-cli/service-adapter.ts`
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–

#### Week 3: Core Services

- [ ] å®ç° `ProviderService`
- [ ] å®ç° `McpService`
- [ ] å®ç° `ConfigService`
- [ ] å®ç° `SyncService`ï¼ˆå¤ç”¨ç°æœ‰é€»è¾‘ï¼‰
- [ ] å®ç° `ToolOrchestrator`
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–

### 3.2 å…¼å®¹å±‚å®ç°

**ä¿ç•™æ—§ APIï¼Œå†…éƒ¨ä»£ç†åˆ°æ–° Servicesï¼š**

```typescript
// packages/core/compat/tool-manager.ts

import { ProviderService } from '../services/provider-service.js';
import type { ToolManager, AddProviderInput, Provider } from './types.js';

/**
 * @deprecated ä½¿ç”¨ ProviderService æ›¿ä»£
 */
export function createCodexManager(): ToolManager {
  console.warn('[Deprecated] createCodexManager() is deprecated. Use ProviderService instead.');

  return {
    add: (input: AddProviderInput): Provider => {
      return ProviderService.add('codex', input);
    },

    list: (): Provider[] => {
      return ProviderService.list('codex');
    },

    switch: (id: string): void => {
      ProviderService.apply('codex', id);
    },

    getCurrent: (): Provider | null => {
      return ProviderService.current('codex');
    },

    edit: (id: string, updates): Provider => {
      return ProviderService.update('codex', id, updates);
    },

    remove: (id: string): void => {
      ProviderService.delete('codex', id);
    },

    clone: (sourceId: string, newName: string): Provider => {
      const source = ProviderService.get('codex', sourceId);
      return ProviderService.clone('codex', source.name, newName);
    },

    get: (id: string): Provider => {
      return ProviderService.get('codex', id);
    },

    findByName: (name: string): Provider | undefined => {
      return ProviderService.findByName('codex', name);
    },

    // å…¶ä»–æ–¹æ³•...
  };
}

// åŒæ ·ä¸º createClaudeManager, createGeminiManager, createMCPManager å®ç°å…¼å®¹å±‚
```

### 3.3 å¯¼å‡ºç­–ç•¥

```typescript
// packages/core/index.ts

// ========== æ–° APIï¼ˆæ¨èä½¿ç”¨ï¼‰ ==========
export { ToolRegistry } from './services/tool-registry.js';
export { ProviderService } from './services/provider-service.js';
export { McpService } from './services/mcp-service.js';
export { ConfigService } from './services/config-service.js';
export { SyncService } from './services/sync-service.js';
export { ToolOrchestrator } from './services/tool-orchestrator.js';

// ========== æ—§ APIï¼ˆå…¼å®¹å±‚ï¼Œå·²æ ‡è®° deprecatedï¼‰ ==========
export {
  createCodexManager,
  createClaudeManager,
  createGeminiManager,
  createMCPManager,
} from './compat/tool-manager.js';

// ========== å…±äº«ç±»å‹ ==========
export type {
  Tool,
  Provider,
  ProviderInput,
  MCPServer,
  MCPServerInput,
  ToolDescriptor,
  // ...
} from './types.js';
```

### 3.4 éªŒè¯æ¸…å•

- [ ] æ‰€æœ‰æ—§ API ä»å¯ç”¨ï¼ˆé€šè¿‡å…¼å®¹å±‚ï¼‰
- [ ] æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡
- [ ] æ–° API å¯ç‹¬ç«‹æµ‹è¯•
- [ ] æ•°æ®æ ¼å¼å®Œå…¨å…¼å®¹ï¼ˆ`~/.ccman/*.json`ï¼‰
- [ ] å®˜æ–¹é…ç½®å†™å…¥é€»è¾‘ä¸å˜ï¼ˆé›¶ç ´åæ€§ï¼‰

---

## å››ã€Phase 2ï¼šCLI è¿ç§»ï¼ˆWeek 4ï¼‰

### 4.1 ä»»åŠ¡åˆ†è§£

- [ ] é‡æ„å‘½ä»¤æ³¨å†Œé€»è¾‘ï¼ˆä» ToolRegistry åŠ¨æ€ç”Ÿæˆï¼‰
- [ ] å®ç°æ–°å‘½ä»¤å¤„ç†å™¨ï¼ˆè°ƒç”¨æ–° APIï¼‰
- [ ] ä¿ç•™æ—§å‘½ä»¤ï¼ˆæ ‡è®° deprecatedï¼‰
- [ ] æ·»åŠ  deprecated è­¦å‘Š
- [ ] æ›´æ–°å¸®åŠ©æ–‡æ¡£
- [ ] é›†æˆæµ‹è¯•

### 4.2 å‘½ä»¤è¿ç§»ç­–ç•¥

#### æ—§å‘½ä»¤ï¼ˆä¿ç•™ï¼Œä½†æ ‡è®° deprecatedï¼‰

```typescript
// packages/cli/src/commands/codex/use.ts

import { createCodexManager } from '@ccman/core';  // æ—§ API

export const use = new Command('use')
  .description('[Deprecated] Use "ccman tool codex use" instead')
  .argument('<id>', 'Provider ID')
  .action((id: string) => {
    console.warn('[Deprecated] This command is deprecated. Use "ccman tool codex use" instead.');

    const manager = createCodexManager();
    manager.switch(id);

    console.log(chalk.green('âœ… åˆ‡æ¢æˆåŠŸ'));
  });
```

#### æ–°å‘½ä»¤ï¼ˆåŠ¨æ€ç”Ÿæˆï¼‰

```typescript
// packages/cli/src/commands/tool.ts

import { ToolRegistry, ProviderService } from '@ccman/core';
import { Command } from 'commander';

export function createToolCommand(): Command {
  const toolCmd = new Command('tool')
    .description('Manage tools (new unified interface)');

  // ä» ToolRegistry åŠ¨æ€ç”Ÿæˆå­å‘½ä»¤
  const tools = ToolRegistry.list();

  tools.forEach((tool) => {
    const subCmd = new Command(tool.id)
      .alias(tool.short)
      .description(tool.displayName);

    // å¦‚æœæ”¯æŒæœåŠ¡å•†ç®¡ç†
    if (tool.capabilities.includes('service')) {
      // æ·»åŠ  add å‘½ä»¤
      subCmd
        .command('add')
        .description('Add a provider')
        .action(() => {
          // äº¤äº’å¼è¾“å…¥
          const input = await promptProviderInput();
          const provider = ProviderService.add(tool.id, input);
          console.log(chalk.green(`âœ… Provider added: ${provider.id}`));
        });

      // æ·»åŠ  use å‘½ä»¤
      subCmd
        .command('use')
        .argument('<name>', 'Provider name')
        .action((name: string) => {
          const provider = ProviderService.apply(tool.id, name);
          console.log(chalk.green(`âœ… Switched to: ${provider.name}`));
        });

      // å…¶ä»–å‘½ä»¤...
    }

    // å¦‚æœæ”¯æŒ MCP
    if (tool.capabilities.includes('mcp')) {
      // æ·»åŠ  MCP ç›¸å…³å‘½ä»¤...
    }

    toolCmd.addCommand(subCmd);
  });

  return toolCmd;
}
```

#### ä¸»å‘½ä»¤å…¥å£

```typescript
// packages/cli/src/index.ts

import { program } from 'commander';
import { createToolCommand } from './commands/tool.js';

// æ–°å‘½ä»¤ï¼ˆæ¨èï¼‰
program.addCommand(createToolCommand());

// æ—§å‘½ä»¤ï¼ˆå…¼å®¹ï¼‰
program.addCommand(createCodexCommand());  // å†…éƒ¨æ ‡è®° deprecated
program.addCommand(createClaudeCommand()); // å†…éƒ¨æ ‡è®° deprecated
program.addCommand(createGeminiCommand()); // å†…éƒ¨æ ‡è®° deprecated
```

### 4.3 éªŒè¯æ¸…å•

- [ ] æ‰€æœ‰æ—§å‘½ä»¤ä»å¯ç”¨ï¼ˆ`ccman cx use`, `ccman cc add` ç­‰ï¼‰
- [ ] æ–°å‘½ä»¤å¯ç”¨ï¼ˆ`ccman tool codex use`, `ccman tool claude-code add` ç­‰ï¼‰
- [ ] äº¤äº’å¼æµ‹è¯•é€šè¿‡
- [ ] å¸®åŠ©æ–‡æ¡£æ›´æ–°
- [ ] é”™è¯¯æç¤ºå‹å¥½

---

## äº”ã€Phase 3ï¼šDesktop è¿ç§»ï¼ˆWeek 5ï¼‰

### 5.1 ä»»åŠ¡åˆ†è§£

- [ ] é‡æ„ Preload æš´éœ²çš„ APIï¼ˆä½¿ç”¨æ–° Core APIï¼‰
- [ ] é‡æ„ Renderer ä½¿ç”¨ ToolRegistry åŠ¨æ€æ¸²æŸ“
- [ ] ä¿ç•™æ—§ IPC handlersï¼ˆæ ‡è®° deprecatedï¼‰
- [ ] æ›´æ–° UI ç»„ä»¶
- [ ] é›†æˆæµ‹è¯•

### 5.2 Preload è¿ç§»

#### æ—§ Preloadï¼ˆä¿ç•™ä½†ä¸æ¨èï¼‰

```typescript
// packages/desktop/src/preload.ts

import { contextBridge, ipcRenderer } from 'electron';
import { createCodexManager } from '@ccman/core';

contextBridge.exposeInMainWorld('electronAPI', {
  // æ—§ APIï¼ˆdeprecatedï¼‰
  codex: {
    add: (input) => ipcRenderer.invoke('codex:add', input),
    list: () => ipcRenderer.invoke('codex:list'),
    // ...
  },

  // æ–° APIï¼ˆæ¨èï¼‰
  tools: {
    list: () => ipcRenderer.invoke('tools:list'),
    provider: {
      add: (tool, input) => ipcRenderer.invoke('provider:add', tool, input),
      list: (tool) => ipcRenderer.invoke('provider:list', tool),
      apply: (tool, name) => ipcRenderer.invoke('provider:apply', tool, name),
      // ...
    },
  },
});
```

#### ä¸»è¿›ç¨‹ IPC Handlers

```typescript
// packages/desktop/src/main/ipc-handlers.ts

import { ipcMain } from 'electron';
import { ToolRegistry, ProviderService } from '@ccman/core';

// æ–° API
ipcMain.handle('tools:list', () => {
  return ToolRegistry.list();
});

ipcMain.handle('provider:add', (event, tool, input) => {
  return ProviderService.add(tool, input);
});

ipcMain.handle('provider:list', (event, tool) => {
  return ProviderService.list(tool);
});

ipcMain.handle('provider:apply', (event, tool, name) => {
  return ProviderService.apply(tool, name);
});

// æ—§ APIï¼ˆå…¼å®¹ï¼‰
ipcMain.handle('codex:add', (event, input) => {
  console.warn('[Deprecated] Use provider:add instead');
  return ProviderService.add('codex', input);
});
```

### 5.3 Renderer åŠ¨æ€æ¸²æŸ“

```typescript
// packages/desktop/src/renderer/components/Sidebar.tsx

import { useEffect, useState } from 'react';
import { ToolDescriptor } from '@ccman/types';

export function Sidebar() {
  const [tools, setTools] = useState<ToolDescriptor[]>([]);

  useEffect(() => {
    window.electronAPI.tools.list().then(setTools);
  }, []);

  return (
    <nav>
      {tools.map((tool) => (
        <Link key={tool.id} to={`/tools/${tool.id}`}>
          {tool.displayName}
        </Link>
      ))}
    </nav>
  );
}
```

### 5.4 éªŒè¯æ¸…å•

- [ ] æ‰€æœ‰é¡µé¢å¯æ­£å¸¸è®¿é—®
- [ ] æ‰€æœ‰åŠŸèƒ½å¯ç”¨ï¼ˆæ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤ã€åˆ‡æ¢ï¼‰
- [ ] æ—§ API ä»å¯ç”¨ï¼ˆé€šè¿‡å…¼å®¹å±‚ï¼‰
- [ ] æ–° UI åŠ¨æ€æ¸²æŸ“æ­£ç¡®
- [ ] è·¨å¹³å°æµ‹è¯•ï¼ˆmacOS/Windows/Linuxï¼‰

---

## å…­ã€Phase 4ï¼šæ¸…ç†å’Œå‘å¸ƒï¼ˆWeek 6ï¼‰

### 6.1 æ¸…ç†ä»»åŠ¡

- [ ] ç§»é™¤ deprecated æ ‡è®°ï¼ˆåœ¨ä¸‹ä¸€ä¸ªå¤§ç‰ˆæœ¬ï¼‰
- [ ] åˆ é™¤æ—§ä»£ç ï¼ˆå…¼å®¹å±‚ï¼‰
- [ ] æ›´æ–°æ‰€æœ‰æ–‡æ¡£
  - [ ] README.md
  - [ ] API æ–‡æ¡£
  - [ ] ç”¨æˆ·æ‰‹å†Œ
  - [ ] è´¡çŒ®æŒ‡å—
- [ ] ç¼–å†™è¿ç§»æŒ‡å—ï¼ˆç»™ç”¨æˆ·ï¼‰

### 6.2 å‘å¸ƒæ¸…å•

- [ ] å®Œæ•´çš„å›å½’æµ‹è¯•
  - [ ] æ‰€æœ‰ CLI å‘½ä»¤
  - [ ] æ‰€æœ‰ Desktop åŠŸèƒ½
  - [ ] WebDAV åŒæ­¥
  - [ ] å¯¼å…¥å¯¼å‡º
- [ ] æ€§èƒ½æµ‹è¯•ï¼ˆç¡®ä¿æ— æ€§èƒ½å›é€€ï¼‰
- [ ] è·¨å¹³å°æµ‹è¯•
- [ ] ç¼–å†™å‘å¸ƒè¯´æ˜ï¼ˆChangelogï¼‰
- [ ] æ‰“åŒ…å‘å¸ƒ
  - [ ] CLI: `npm publish`
  - [ ] Desktop: dmg/exe/AppImage

### 6.3 å‘å¸ƒè¯´æ˜æ¨¡æ¿

```markdown
# v2.0.0 - å®Œå…¨é‡æ„ç‰ˆ

## ğŸ‰ é‡å¤§æ›´æ–°

ccman è¿›è¡Œäº†å®Œå…¨é‡æ„ï¼Œé‡‡ç”¨"å·¥å…·å³æ’ä»¶"æ¶æ„ï¼Œå¸¦æ¥ä»¥ä¸‹æ”¹è¿›ï¼š

- âœ… **å®Œå…¨å¯æ‰©å±•ï¼š** æ·»åŠ æ–°å·¥å…·åªéœ€ 200 è¡Œä»£ç 
- âœ… **ç»Ÿä¸€æ¥å£ï¼š** æ‰€æœ‰å·¥å…·é€šè¿‡ç»Ÿä¸€çš„ Adapter ç®¡ç†
- âœ… **æ¨¡æ¿é©±åŠ¨ï¼š** é…ç½®æ–‡ä»¶å®Œå…¨æ¨¡æ¿åŒ–
- âœ… **åŠ¨æ€ CLI/UIï¼š** å‘½ä»¤å’Œç•Œé¢è‡ªåŠ¨ç”Ÿæˆ

## ğŸ“¦ æ–°åŠŸèƒ½

- æ–°å¢ `ToolRegistry` API
- æ–°å¢ `ProviderService` API
- æ–°å¢ `McpService` API
- æ–°å¢ `ConfigService` API
- æ–°å¢ `ToolOrchestrator` API
- æ”¯æŒæ ¹ç›®å½•æŒä¹…åŒ–åˆ‡æ¢ï¼ˆ`setRootDir`ï¼‰

## âš ï¸ ç ´åæ€§å˜æ›´

æ— ï¼æ‰€æœ‰æ—§ API ä¿ç•™å¹¶å®Œå…¨å…¼å®¹ã€‚

## ğŸš€ è¿ç§»æŒ‡å—

### å¯¹ CLI ç”¨æˆ·

æ‰€æœ‰ç°æœ‰å‘½ä»¤ä»å¯ç”¨ï¼Œæ— éœ€ä¿®æ”¹ã€‚æ¨èä½¿ç”¨æ–°å‘½ä»¤ï¼š

```bash
# æ—§å‘½ä»¤ï¼ˆä»å¯ç”¨ï¼‰
ccman cx use openai

# æ–°å‘½ä»¤ï¼ˆæ¨èï¼‰
ccman tool codex use openai
```

### å¯¹å¼€å‘è€…

æ—§ API å·²æ ‡è®° `@deprecated`ï¼Œä½†ä»å¯ç”¨ã€‚å»ºè®®è¿ç§»åˆ°æ–° APIï¼š

```typescript
// æ—§ API
import { createCodexManager } from '@ccman/core';
const manager = createCodexManager();
manager.add({ ... });

// æ–° APIï¼ˆæ¨èï¼‰
import { ProviderService } from '@ccman/core';
ProviderService.add('codex', { ... });
```

å®Œæ•´è¿ç§»æŒ‡å—ï¼š[æŸ¥çœ‹æ–‡æ¡£](./docs/migration-guide.md)

## ğŸ› Bug ä¿®å¤

- ä¿®å¤æµ‹è¯•ç¯å¢ƒè·¯å¾„å¸¦ PID å¯¼è‡´çš„é—®é¢˜
- ä¿®å¤æ¨¡æ¿åˆå¹¶æ—¶çš„è¾¹ç•Œæƒ…å†µ
- å…¶ä»–å°ä¿®å¤...

## ğŸ“š æ–‡æ¡£æ›´æ–°

- æ–°å¢å®Œæ•´çš„æ¶æ„è®¾è®¡æ–‡æ¡£
- æ–°å¢å·¥å…·æ·»åŠ æŒ‡å—
- æ›´æ–° API å‚è€ƒæ–‡æ¡£
- æ›´æ–°ç”¨æˆ·æ‰‹å†Œ

## ğŸ’¬ åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œæ¬¢è¿æ Issueï¼šhttps://github.com/your-org/ccman/issues

**æ„Ÿè°¢ä½¿ç”¨ ccmanï¼**
```

---

## ä¸ƒã€å›æ»šç­–ç•¥

### 7.1 å›æ»šè§¦å‘æ¡ä»¶

- å‘ç°ä¸¥é‡ Bug å¯¼è‡´æ•°æ®ä¸¢å¤±
- æ€§èƒ½ä¸¥é‡å›é€€ï¼ˆ> 50%ï¼‰
- è·¨å¹³å°å…¼å®¹æ€§é—®é¢˜æ— æ³•å¿«é€Ÿä¿®å¤

### 7.2 å›æ»šæ­¥éª¤

#### Step 1: ç«‹å³åœæ­¢å‘å¸ƒ

```bash
# æ’¤å› npm å‘å¸ƒï¼ˆå¦‚æœåœ¨ 72 å°æ—¶å†…ï¼‰
npm unpublish ccman@2.0.0

# æˆ–å‘å¸ƒ hotfix ç‰ˆæœ¬æŒ‡å‘æ—§ä»£ç 
npm publish ccman@2.0.1
```

#### Step 2: åˆ‡å›æ—§åˆ†æ”¯

```bash
git checkout main
git revert <refactor-merge-commit>
git push
```

#### Step 3: é€šçŸ¥ç”¨æˆ·

```markdown
# ç´§æ€¥é€šçŸ¥ï¼šv2.0.0 å›æ»š

ç”±äºå‘ç°ä¸¥é‡é—®é¢˜ï¼Œv2.0.0 å·²å›æ»šè‡³ v1.x.xã€‚

è¯·æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š
1. å¸è½½ v2.0.0ï¼š`npm uninstall -g ccman`
2. å®‰è£…ç¨³å®šç‰ˆï¼š`npm install -g ccman@1.x.x`

å¦‚æœå·²ä½¿ç”¨ v2.0.0ï¼Œé…ç½®æ–‡ä»¶ä»ç„¶å…¼å®¹ï¼Œæ— éœ€æ‹…å¿ƒã€‚

æˆ‘ä»¬å°†å°½å¿«ä¿®å¤é—®é¢˜å¹¶é‡æ–°å‘å¸ƒã€‚

æŠ±æ­‰ç»™æ‚¨å¸¦æ¥ä¸ä¾¿ã€‚
```

### 7.3 æ•°æ®å…¼å®¹æ€§ä¿è¯

**æ‰€æœ‰é˜¶æ®µéƒ½ä¿è¯æ•°æ®å…¼å®¹ï¼š**
- `~/.ccman/*.json` æ ¼å¼ä¸å˜
- å®˜æ–¹é…ç½®æ–‡ä»¶ï¼ˆ`~/.codex`, `~/.claude`, `~/.gemini`ï¼‰æ ¼å¼ä¸å˜
- å¤‡ä»½æ–‡ä»¶ï¼ˆ`.bak`ï¼‰ä»å¯ç”¨

**å³ä½¿å›æ»šï¼Œç”¨æˆ·æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚**

---

## å…«ã€é£é™©ç®¡ç†

### 8.1 å·²è¯†åˆ«çš„é£é™©

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|---------|
| **å…¼å®¹å±‚ Bug** | æ—§ API è°ƒç”¨å¤±è´¥ | å……åˆ†æµ‹è¯•å…¼å®¹å±‚ï¼Œä¿ç•™æ—§ä»£ç ä½œä¸ºå‚è€ƒ |
| **æ€§èƒ½å›é€€** | ç”¨æˆ·ä½“éªŒä¸‹é™ | æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼Œä¼˜åŒ–çƒ­ç‚¹è·¯å¾„ |
| **å®˜æ–¹é…ç½®æ ¼å¼å˜æ›´** | å†™å…¥å¤±è´¥ | Adapter éš”ç¦»ï¼Œæ¨¡æ¿ç‰ˆæ§ |
| **åŒæ­¥å†²çª** | äº‘åŒæ­¥å¤±è´¥ | MergePlanner è¾“å‡ºå†²çªæŠ¥å‘Šï¼Œæç¤ºç”¨æˆ·æ‰‹åŠ¨é€‰æ‹© |
| **è·¨å¹³å°å…¼å®¹æ€§** | æŸäº›å¹³å°æ— æ³•è¿è¡Œ | æ¯ä¸ªå¹³å°éƒ½è¿›è¡Œæµ‹è¯• |

### 8.2 ç›‘æ§æŒ‡æ ‡

**å‘å¸ƒåç›‘æ§ï¼š**
- [ ] npm ä¸‹è½½é‡ï¼ˆæ˜¯å¦éª¤é™ï¼‰
- [ ] GitHub Issuesï¼ˆæ–° Bug æ•°é‡ï¼‰
- [ ] ç”¨æˆ·åé¦ˆï¼ˆDiscord/Redditï¼‰
- [ ] æ€§èƒ½æŒ‡æ ‡ï¼ˆå‘½ä»¤æ‰§è¡Œæ—¶é—´ï¼‰

---

## ä¹ã€é‡Œç¨‹ç¢‘å’Œæ—¶é—´è¡¨

```
Week 1 (Dec 9 - Dec 15)
  â”œâ”€ Phase 0: å‡†å¤‡æœŸ
  â””â”€ è¾“å‡ºï¼šè®¾è®¡æ–‡æ¡£å®Œæˆã€åˆ†æ”¯åˆ›å»º

Week 2 (Dec 16 - Dec 22)
  â”œâ”€ Phase 1.1: åŸºç¡€è®¾æ–½å’Œå·¥å…·æ³¨å†Œ
  â””â”€ è¾“å‡ºï¼šToolRegistryã€Adapters å®Œæˆ

Week 3 (Dec 23 - Dec 29)
  â”œâ”€ Phase 1.2: Core Services
  â””â”€ è¾“å‡ºï¼šProviderServiceã€McpService å®Œæˆ

Week 4 (Dec 30 - Jan 5)
  â”œâ”€ Phase 2: CLI è¿ç§»
  â””â”€ è¾“å‡ºï¼šCLI æ–°å‘½ä»¤å¯ç”¨

Week 5 (Jan 6 - Jan 12)
  â”œâ”€ Phase 3: Desktop è¿ç§»
  â””â”€ è¾“å‡ºï¼šDesktop æ–° UI å¯ç”¨

Week 6 (Jan 13 - Jan 19)
  â”œâ”€ Phase 4: æ¸…ç†å’Œå‘å¸ƒ
  â””â”€ è¾“å‡ºï¼šv2.0.0 æ­£å¼å‘å¸ƒ
```

---

## åã€æˆåŠŸæ ‡å‡†

### 10.1 æŠ€æœ¯æŒ‡æ ‡

- âœ… æ‰€æœ‰ç°æœ‰åŠŸèƒ½ä¿ç•™ï¼ˆ100%ï¼‰
- âœ… æ‰€æœ‰å•å…ƒæµ‹è¯•é€šè¿‡ï¼ˆ> 80% è¦†ç›–ç‡ï¼‰
- âœ… é›†æˆæµ‹è¯•é€šè¿‡ï¼ˆ100%ï¼‰
- âœ… æ€§èƒ½æ— å›é€€ï¼ˆ< 10% å·®å¼‚ï¼‰
- âœ… è·¨å¹³å°å…¼å®¹ï¼ˆmacOS/Windows/Linuxï¼‰

### 10.2 ç”¨æˆ·ä½“éªŒæŒ‡æ ‡

- âœ… ç”¨æˆ·æ— éœ€ä¿®æ”¹ä»»ä½•é…ç½®æˆ–è„šæœ¬
- âœ… æ‰€æœ‰ CLI å‘½ä»¤ä»å¯ç”¨
- âœ… Desktop æ‰€æœ‰åŠŸèƒ½ä»å¯ç”¨
- âœ… é”™è¯¯ä¿¡æ¯å‹å¥½
- âœ… æ–‡æ¡£å®Œå–„

### 10.3 å¯æ‰©å±•æ€§æŒ‡æ ‡

- âœ… æ·»åŠ æ–°å·¥å…·åªéœ€ < 300 è¡Œä»£ç 
- âœ… CLI/Desktop æ— éœ€ä¿®æ”¹
- âœ… ç±»å‹å®‰å…¨ï¼ˆTypeScriptï¼‰
- âœ… æ˜“äºæµ‹è¯•ï¼ˆç‹¬ç«‹å•å…ƒæµ‹è¯•ï¼‰

---

**æ­å–œï¼å¦‚æœä½ å®Œæˆäº†è¿™ä¸ªè¿ç§»è®¡åˆ’ï¼Œccman å°†æˆä¸ºä¸€ä¸ªçœŸæ­£å¯æ‰©å±•ã€æ˜“ç»´æŠ¤çš„å·¥å…·ã€‚**

---

**ç›¸å…³æ–‡æ¡£ï¼š**
- [ç°æœ‰åŠŸèƒ½æ€»ç»“](./00-ç°æœ‰åŠŸèƒ½æ€»ç»“.md)
- [æ–°æ¶æ„è®¾è®¡](./01-æ–°æ¶æ„è®¾è®¡.md)
- [æ ¸å¿ƒ API å®šä¹‰](./02-æ ¸å¿ƒAPIå®šä¹‰.md)
- [æ–°å·¥å…·æ·»åŠ æŒ‡å—](./03-æ–°å·¥å…·æ·»åŠ æŒ‡å—.md)
